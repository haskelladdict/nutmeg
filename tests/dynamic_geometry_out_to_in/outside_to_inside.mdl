ITERATIONS = 10
TIME_STEP = 1e-6

WARNINGS
{
    LARGE_MOLECULAR_DISPLACEMENT = IGNORED
}

DYNAMIC_GEOMETRY = "./list_of_geometry.txt"

DEFINE_MOLECULES
{
  vm1 { DIFFUSION_CONSTANT_3D = 1e-08 }
  vm2 { DIFFUSION_CONSTANT_3D = 1e-08 }
  vm3 { DIFFUSION_CONSTANT_3D = 1e-08 }
  vm4 { DIFFUSION_CONSTANT_3D = 1e-08 }
}

INCLUDE_FILE = "./geom_1.mdl"

DEFINE_SURFACE_CLASSES
{
  transp_vm234
  {
    TRANSPARENT = vm2'
    TRANSPARENT = vm3'
    TRANSPARENT = vm4'
  }
  transp_vm34
  {
    TRANSPARENT = vm3'
    TRANSPARENT = vm4'
  }
  transp_vm4
  {
    TRANSPARENT = vm4'
  }
}

// Block vm1 from entering outermost cube (C)
// Block vm2 from entering middle cube (B)
// Block vm3 from enter inner cube (A)
// Let vm4 pass through everything to center
MODIFY_SURFACE_REGIONS
{
  C[ALL]
  {
    SURFACE_CLASS = transp_vm234
  }
  B[ALL]
  {
    SURFACE_CLASS = transp_vm34
  }
  A[ALL]
  {
    SURFACE_CLASS = transp_vm4
  }
}

INSTANTIATE Scene OBJECT
{
  A OBJECT A{}
  B OBJECT B{}
  C OBJECT C{}
  rel_vm1 RELEASE_SITE
  {
    SHAPE = CUBIC
    MOLECULE = vm1
    NUMBER_TO_RELEASE = 100
    SITE_DIAMETER = 0.0
    LOCATION = [0.31, 0.0, 0.0]
  }
  rel_vm2 RELEASE_SITE
  {
    SHAPE = CUBIC
    MOLECULE = vm2
    NUMBER_TO_RELEASE = 100
    SITE_DIAMETER = 0.0
    LOCATION = [0.31, 0.0, 0.0]
  }
  rel_vm3 RELEASE_SITE
  {
    SHAPE = CUBIC
    MOLECULE = vm3
    NUMBER_TO_RELEASE = 100
    SITE_DIAMETER = 0.0
    LOCATION = [0.31, 0.0, 0.0]
  }
  rel_vm4 RELEASE_SITE
  {
    SHAPE = CUBIC
    MOLECULE = vm4
    NUMBER_TO_RELEASE = 100
    SITE_DIAMETER = 0.0
    LOCATION = [0.31, 0.0, 0.0]
  }
  
}

REACTION_DATA_OUTPUT
{
  STEP=1e-06
  HEADER=OFF
  // vm1
  {COUNT[vm1,Scene.A]:"A",
   COUNT[vm1,Scene.B]-COUNT[vm1,Scene.A]:"B",
   COUNT[vm1,Scene.C]-COUNT[vm1,Scene.B]:"C",
   COUNT[vm1,WORLD]-COUNT[vm1,Scene.C]:"WORLD"}=> "./vm1.dat"
  // vm2
  {COUNT[vm2,Scene.A]:"A",
   COUNT[vm2,Scene.B]-COUNT[vm2,Scene.A]:"B",
   COUNT[vm2,Scene.C]-COUNT[vm2,Scene.B]:"C",
   COUNT[vm2,WORLD]-COUNT[vm2,Scene.C]:"WORLD"}=> "./vm2.dat"
  // vm3
  {COUNT[vm3,Scene.A]:"A",
   COUNT[vm3,Scene.B]-COUNT[vm3,Scene.A]:"B",
   COUNT[vm3,Scene.C]-COUNT[vm3,Scene.B]:"C",
   COUNT[vm3,WORLD]-COUNT[vm3,Scene.C]:"WORLD"}=> "./vm3.dat"
  // vm4
  {COUNT[vm4,Scene.A]:"A",
   COUNT[vm4,Scene.B]-COUNT[vm4,Scene.A]:"B",
   COUNT[vm4,Scene.C]-COUNT[vm4,Scene.B]:"C",
   COUNT[vm4,WORLD]-COUNT[vm4,Scene.C]:"WORLD"}=> "./vm4.dat"
}

/*VIZ_OUTPUT*/
/*{*/
/*  MODE = CELLBLENDER*/
/*  FILENAME = "./viz_data/Scene"*/
/*  MOLECULES*/
/*  {*/
/*    NAME_LIST {ALL_MOLECULES}*/
/*    ITERATION_NUMBERS {ALL_DATA @ ALL_ITERATIONS}*/
/*  }*/
/*}*/
