/*
 * 
 * this test checks that the proper average number of molecules is
 * released by a concentration clamp either on both sides or a single
 * side of a surface.
 *
 * The expected number of molecules is (0.2*0.2*0.2):
 *
 * 0.0001*6.0221417930e23*(0.2*0.2*0.2)/1e15 = 481.77
 * 
 * i.e., 482 number of molecules expected for release on both sides and 
 * 241 molecules for release on a single side.
 *
 * Test created 02/16/2015 by Markus Dittrich
 */

ITERATIONS = 3000
TIME_STEP = 1e-06
VACANCY_SEARCH_DISTANCE = 10

PARTITION_X = [[-0.304011 TO 0.295989 STEP 0.02]]
PARTITION_Y = [[-0.283002 TO 0.316998 STEP 0.02]]
PARTITION_Z = [[-0.286331 TO 0.313669 STEP 0.02]]

DEFINE_MOLECULES
{
  A
  {
    DIFFUSION_CONSTANT_3D = 2e-06
  }
  B
  {
    DIFFUSION_CONSTANT_3D = 2e-06
  }

}

DEFINE_SURFACE_CLASSES
{
  clamper
  {
    CLAMP_CONCENTRATION A, = 0.0001
    CLAMP_CONCENTRATION B; = 0.0001
  }
}

Cube POLYGON_LIST
{
  VERTEX_LIST
  {
    [ 0.0945145636796951, 0.118083991110325, -0.085484005510807 ]
    [ 0.0939290747046471, -0.081914022564888, -0.0861665010452271 ]
    [ -0.10606899112463, -0.0813308283686638, -0.0854891315102577 ]
    [ -0.105483449995518, 0.118667215108871, -0.0848066359758377 ]
    [ 0.0951899811625481, 0.117399469017982, 0.114513732492924 ]
    [ 0.094604380428791, -0.0825985595583916, 0.113831236958504 ]
    [ -0.105393640697002, -0.0820152834057808, 0.114508606493473 ]
    [ -0.104808107018471, 0.11798270046711, 0.115191102027893 ]
    [ 0.0942218154668808, 0.0180849824100733, -0.0858252570033073 ]
    [ -0.00548444502055645, 0.118375599384308, -0.0851453170180321 ]
    [ 0.0948522686958313, 0.117741733789444, 0.0145148634910583 ]
    [ -0.00606995075941086, -0.0816224217414856, -0.0858278200030327 ]
    [ 0.0942667275667191, -0.0822562798857689, 0.0138323660939932 ]
    [ -0.105776220560074, 0.0186681933701038, -0.0851478800177574 ]
    [ -0.105731308460236, -0.0816730633378029, 0.0145097374916077 ]
    [ -0.105145782232285, 0.118324957787991, 0.0151922348886728 ]
    [ 0.0948971807956696, 0.0174004603177309, 0.114172481000423 ]
    [ -0.00480906525626779, 0.117691092193127, 0.114852420985699 ]
    [ -0.00539463059976697, -0.0823069214820862, 0.114169918000698 ]
    [ -0.105100870132446, 0.0179837085306644, 0.114849857985973 ]
    [ -0.00577718857675791, 0.018376599997282, -0.0854865685105324 ]
    [ -0.00510186282917857, 0.0176920779049397, 0.114511169493198 ]
    [ 0.0945594683289528, 0.0177427213639021, 0.0141736157238483 ]
    [ -0.00573228765279055, -0.0819646567106247, 0.0141710517928004 ]
    [ -0.10543854534626, 0.018325962126255, 0.0148509861901402 ]
    [ -0.0051467758603394, 0.118033349514008, 0.0148535491898656 ]
  }
  ELEMENT_CONNECTIONS
  {
    [ 1, 11, 20 ]
    [ 7, 19, 21 ]
    [ 0, 10, 22 ]
    [ 1, 12, 23 ]
    [ 6, 19, 24 ]
    [ 0, 9, 25 ]
    [ 0, 8, 9 ]
    [ 4, 17, 16 ]
    [ 1, 8, 12 ]
    [ 2, 11, 14 ]
    [ 2, 14, 13 ]
    [ 4, 10, 17 ]
    [ 20, 13, 3 ]
    [ 20, 11, 13 ]
    [ 11, 2, 13 ]
    [ 21, 18, 5 ]
    [ 21, 19, 18 ]
    [ 19, 6, 18 ]
    [ 22, 16, 5 ]
    [ 22, 10, 16 ]
    [ 10, 4, 16 ]
    [ 23, 18, 6 ]
    [ 23, 12, 18 ]
    [ 12, 5, 18 ]
    [ 24, 15, 3 ]
    [ 24, 19, 15 ]
    [ 19, 7, 15 ]
    [ 25, 15, 7 ]
    [ 25, 9, 15 ]
    [ 9, 3, 15 ]
    [ 9, 20, 3 ]
    [ 9, 8, 20 ]
    [ 8, 1, 20 ]
    [ 16, 21, 5 ]
    [ 16, 17, 21 ]
    [ 17, 7, 21 ]
    [ 12, 22, 5 ]
    [ 12, 8, 22 ]
    [ 8, 0, 22 ]
    [ 14, 23, 6 ]
    [ 14, 11, 23 ]
    [ 11, 1, 23 ]
    [ 13, 24, 3 ]
    [ 13, 14, 24 ]
    [ 14, 6, 24 ]
    [ 17, 25, 7 ]
    [ 17, 10, 25 ]
    [ 10, 0, 25 ]
  }
  DEFINE_SURFACE_REGIONS
  {
    all_cube
    {
      ELEMENT_LIST = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47]
    }
  }
}

Plane POLYGON_LIST
{
  VERTEX_LIST
  {
    [ -0.00548444502055645, 0.118375599384308, -0.0851453170180321 ]
    [ -0.00606995075941086, -0.0816224217414856, -0.0858278200030327 ]
    [ -0.00480906525626779, 0.117691092193127, 0.114852420985699 ]
    [ -0.00539463059976697, -0.0823069214820862, 0.114169918000698 ]
  }
  ELEMENT_CONNECTIONS
  {
    [ 3, 2, 0 ]
    [ 1, 3, 0 ]
  }
  DEFINE_SURFACE_REGIONS
  {
    all_plane
    {
      ELEMENT_LIST = [0, 1]
      SURFACE_CLASS = clamper
    }
  }
}

INSTANTIATE Scene OBJECT
{
  Cube OBJECT Cube {}
  Plane OBJECT Plane {}
}

sprintf(seed,"%05g",SEED)

REACTION_DATA_OUTPUT
{
  STEP=1e-06
  {COUNT[A,Scene.Cube]}=> "./A_cube.dat"
  {COUNT[B,Scene.Cube]}=> "./B_cube.dat"
}

